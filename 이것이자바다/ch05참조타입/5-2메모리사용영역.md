# 5.2 메모리 사용 영역
- JVM은 운영체제에서 할당받은 `메모리 영역`(Runtime Data Area)를 다음과 같은 세부 영역으로 구부해서 사용한다.
![p140그림](https://user-images.githubusercontent.com/40673012/99615029-0e4aaf00-2a5e-11eb-863c-b9b3bc09f417.png)

## 5.2.1 메소드(Method) 영역
- 코드에서 사용되는 클래스(~.class)들을 `클래스 로더`로 읽어 클래스별로 런타임 상수풀(runtime constant poll),    <br />
필드 데이터, 메소드 데이터, 메소드 코드, 생성자 코드 등을 분류해서 저장한다. <br />
- JVM이 시작할 때 생성되고 `모든 스레드가 공유`하는 영역이다.

## 5.2.2 힙 영역
- 객체와 배열이 생성되는 영역이다. 
- 힙 영역에 생성된 객체와 배열은 JVM 스택 영역의 변수나 다른 객체의 필드에서 참조한다. 
- 참조하는 변수나 필드가 없다면 의미 없는 객체가 되므로, JVM은 Garbage Collector를 실행시켜 해당 객체를 힙 영역에서 자동으로 제거한다.
    - 때문에 객체 제거를 위한 코드를 작성할 필요가 없고, 자바는 코드로 객체를 직접 제거하는 방법을 제공하지 않는다.

## 5.2.3 JVM 스택 영역
- 각 `스레드`마다 하나씩 존재하며 스레드가 시작될 때 할당된다.
- 자바 프로그램에서 추가적으로 스레드를 생성하지 않았다면 main 스레드만 존재하므로 JVM 스택도 하나다.
- JVM 스택은 `메소드`를 호출할 떄마다 `프레임`(Frame)을 추가(push)하고 메소드가 종료되면 해당 프레임을 제거(pop)한다.
    - 예외 발생 시 printStackTrace() 메소드로 보여주는 Stack Trace의 각 라인은 하나의 프레임을 표현한다.
- `프레임` 내부에는 `로컬 변수 스택`이 있으며, `기본 타입 변수`와 `참조 타입 변수`가 추가(push)되거나 제거(pop)된다. 변수가 이 영역에 생성되는 시점은 초기화 될 때다.
- 변수는 선언된 블록 안에서만 스택에 존재하고 블록을 벗어나면 스택에서 제거된다.
- 기본 타입 변수는 스택 영역에서 직접 값을 가지지만, 참조 타입 변수는 값이 아니라 힙 영역이나 메소드 영역의 객체 주소를 가진다. 
```java
int[] scores = {10, 20, 30};
```

<img width="342" alt="p142그림2" src="https://user-images.githubusercontent.com/40673012/99735007-33472c80-2b07-11eb-8fa2-d8039d623cfe.png">


- 내부 구조 참고할 블로그 (클래스 변수, 전역 변수 등은 어떻게 메모리에 적재되는가) https://codingdog.tistory.com/entry/java-%ED%81%B4%EB%9E%98%EC%8A%A4-%EB%B3%80%EC%88%98-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%A9%94%EB%AA%A8%EB%A6%AC%EC%97%90-%EC%98%AC%EB%9D%BC%EA%B0%88%EA%B9%8C
